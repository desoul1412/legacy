{# ETL Layout Template
   
   Variables:
   - project: Project name (e.g., 'rolling_forecast', 'game_health_check')
   - layout_name: Layout identifier (e.g., 'active_details', 'charge')
   - table_name: Source table name
   - columns: List of column names
   - where_clause: Optional WHERE clause conditions
   - description: Layout description
#}
{
  "mode": "etl",
  "project": "{{ project }}",
  "layout_name": "{{ layout_name }}",
  "description": "{{ description }}",
  "source": {
    "type": "postgres",
    "where": "gds",
    "database": "{gameId}_raw",
    "table": "{{ table_name }}",
    "columns": [
      {% for col in columns %}
      "{{ col }}"{{ ',' if not loop.last else '' }}
      {% endfor %}
    ],
    "filters": {
      {% if where_clause %}
      "where": "{{ where_clause }}"
      {% else %}
      "where": "report_date = '{logDate}'"
      {% endif %}
    }
  },
  "target": {
    "type": "hdfs",
    "path": "/user/gsbkk-workspace-yc9t6/{{ project }}/etl/{{ layout_name }}/{gameId}/{logDate}",
    "format": "parquet",
    "mode": "overwrite",
    "partition": {
      "enable": false
    }
  },
  "metadata": {
    "version": "3.0",
    "created_by": "jinja2_template",
    "template_file": "templates/layouts/etl_layout.json.j2"
  }
}
