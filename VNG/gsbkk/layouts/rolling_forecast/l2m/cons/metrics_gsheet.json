{
  "description": "L2M Rolling Forecast - Consolidate metrics from diagnostic_daily for specific country and write to Postgres + Google Sheet",
  "comment": "Multi-market game: Pass countryCode variable from DAG to filter data for specific country",
  "inputSources": [
    {
      "name": "diagnostic",
      "type": "jdbc",
      "connection": "TSN_POSTGRES",
      "sqlTemplate": "templates/rolling_forecast/rolling_forecast_gsheet.sql.j2"
    }
  ],
  "outputs": [
    {
      "name": "gsheet",
      "type": "gsheet",
      "sheet_id": "{rfcSheetId}",
      "range": "Daily Actual!A3",
      "columns": ["report_date", "install", "nru", "rr01", "dau", "pu", "npu", "rev_usd", "cost"],
      "sort_by": [{"column": "report_date", "order": "desc"}],
      "update_mode": "upsert",
      "key_column": "report_date"
    }
  ]
}
